!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/wp-content/plugins/connect-to-apple-music/dist/",i(i.s=94)}([,function(e,t){var i=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=i)},function(e,t){var i=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},,function(e,t,i){e.exports=!i(11)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,i){var n=i(2),r=i(1),o=i(24),s=i(20),a=i(13),c=function(e,t,i){var l,u,p,d=e&c.F,h=e&c.G,f=e&c.S,m=e&c.P,v=e&c.B,g=e&c.W,b=h?r:r[t]||(r[t]={}),y=b.prototype,w=h?n:f?n[t]:(n[t]||{}).prototype;for(l in h&&(i=t),i)(u=!d&&w&&void 0!==w[l])&&a(b,l)||(p=u?w[l]:i[l],b[l]=h&&"function"!=typeof w[l]?i[l]:v&&u?o(p,n):g&&w[l]==p?function(e){var t=function(t,i,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,i)}return new e(t,i,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(p):m&&"function"==typeof p?o(Function.call,p):p,m&&((b.virtual||(b.virtual={}))[l]=p,e&c.R&&y&&!y[l]&&s(y,l,p)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},,,,function(e,t,i){var n=i(5);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,i){var n=i(10),r=i(47),o=i(36),s=Object.defineProperty;t.f=i(4)?Object.defineProperty:function(e,t,i){if(n(e),t=o(t,!0),n(i),r)try{return s(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(e[t]=i.value),e}},function(e,t){var i={}.hasOwnProperty;e.exports=function(e,t){return i.call(e,t)}},,,,,,function(e,t,i){var n=i(45),r=i(32);e.exports=function(e){return n(r(e))}},function(e,t,i){var n=i(12),r=i(29);e.exports=i(4)?function(e,t,i){return n.f(e,t,r(1,i))}:function(e,t,i){return e[t]=i,e}},,,function(e,t){var i={}.toString;e.exports=function(e){return i.call(e).slice(8,-1)}},function(e,t,i){var n=i(30);e.exports=function(e,t,i){if(n(e),void 0===t)return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,r){return e.call(t,i,n,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=!0},,function(e,t,i){var n=i(46),r=i(34);e.exports=Object.keys||function(e){return n(e,r)}},function(e,t){var i=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:i)(e)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var i=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++i+n).toString(36))}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},,function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},,function(e,t,i){var n=i(5);e.exports=function(e,t){if(!n(e))return e;var i,r;if(t&&"function"==typeof(i=e.toString)&&!n(r=i.call(e)))return r;if("function"==typeof(i=e.valueOf)&&!n(r=i.call(e)))return r;if(!t&&"function"==typeof(i=e.toString)&&!n(r=i.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t,i){var n=i(5),r=i(2).document,o=n(r)&&n(r.createElement);e.exports=function(e){return o?r.createElement(e):{}}},function(e,t,i){var n=i(1),r=i(2),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:i(25)?"pure":"global",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t,i){var n=i(38)("keys"),r=i(31);e.exports=function(e){return n[e]||(n[e]=r(e))}},function(e,t,i){var n=i(32);e.exports=function(e){return Object(n(e))}},,,,function(e,t,i){var n=i(28),r=Math.min;e.exports=function(e){return e>0?r(n(e),9007199254740991):0}},function(e,t,i){var n=i(23);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,i){var n=i(13),r=i(19),o=i(58)(!1),s=i(39)("IE_PROTO");e.exports=function(e,t){var i,a=r(e),c=0,l=[];for(i in a)i!=s&&n(a,i)&&l.push(i);for(;t.length>c;)n(a,i=t[c++])&&(~o(l,i)||l.push(i));return l}},function(e,t,i){e.exports=!i(4)&&!i(11)(function(){return 7!=Object.defineProperty(i(37)("div"),"a",{get:function(){return 7}}).a})},function(e,t,i){e.exports={default:i(92),__esModule:!0}},,,,,,,,,function(e,t,i){var n=i(28),r=Math.max,o=Math.min;e.exports=function(e,t){return(e=n(e))<0?r(e+t,0):o(e,t)}},function(e,t,i){var n=i(19),r=i(44),o=i(57);e.exports=function(e){return function(t,i,s){var a,c=n(t),l=r(c.length),u=o(s,l);if(e&&i!=i){for(;l>u;)if((a=c[u++])!=a)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===i)return e||u||0;return!e&&-1}}},,function(e,t,i){var n=i(6),r=i(1),o=i(11);e.exports=function(e,t){var i=(r.Object||{})[e]||Object[e],s={};s[e]=t(i),n(n.S+n.F*o(function(){i(1)}),"Object",s)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){},function(e,t,i){var n=i(40),r=i(27);i(60)("keys",function(){return function(e){return r(n(e))}})},function(e,t,i){i(91),e.exports=i(1).Object.keys},function(e,t,i){"use strict";i.r(t);var n=i(48),r=i.n(n),o=wp.media,s=o.view.Settings.AttachmentDisplay.extend({template:wp.template("apple-music-sidebar"),initialize:function(){o.view.Settings.AttachmentDisplay.prototype.initialize.apply(this)},render:function(){return _.extend(this.options,{description:this.options.model.attributes.description,content:this.options.model.attributes.content,shouldDisplayPlayer:["songs","albums","playlists"].includes(this.options.tab)}),o.view.Settings.AttachmentDisplay.prototype.render.call(this),this}});o.view.AppleMusicItem=wp.Backbone.View.extend({tagName:"li",className:"apple-music-item attachment",render:function(){return this.template=o.template("apple-music-item"),this.model.set("tab",this.attributes.tab),this.$el.html(this.template(this.model.toJSON())),this}}),o.view.Toolbar.AppleMusic=o.view.Toolbar.extend({initialize:function(){_.defaults(this.options,{event:"inserter",close:!1,items:{inserter:{id:"apple-music-button",style:"primary",text:appleMusic.labels.insert,priority:80,click:function(){this.controller.state().appleMusicInsert()}}}}),o.view.Toolbar.prototype.initialize.apply(this),this.set("pagination",new o.view.Button({tagName:"button",classes:"apple-music-pagination button button-secondary",id:"apple-music-loadmore",text:appleMusic.labels.loadmore,priority:-20}))},refresh:function(){var e=this.controller.state().props.get("_all").get("selection");jQuery("#apple-music-button").prop("disabled",!e.length),o.view.Toolbar.prototype.refresh.apply(this)}}),o.view.AppleMusic=o.View.extend({events:{"click .apple-music-item-area":"toggleSelectionHandler","click .apple-music-item .check":"removeSelectionHandler","submit .apple-music-toolbar form":"updateInput"},initialize:function(){var e=this;this.collection=new Backbone.Collection,this.tab=this.options.tab,this.createSidebar(),this.createToolbar(),this.clearItems(),this.model.get("items")?(this.collection=new Backbone.Collection,this.collection.reset(this.model.get("items")),jQuery("#apple-music-loadmore").attr("disabled",!0).show()):jQuery("#apple-music-loadmore").hide(),this.collection.on("reset",this.render,this),this.model.on("change:params",this.changedParams,this),this.on("loading",this.loading,this),this.on("loaded",this.loaded,this),this.on("change:params",this.changedParams,this),this.on("change:page",this.changedPage,this),setTimeout(function(){jQuery(".apple-music-pagination").click(function(t){e.paginate(t)})},0),this.model.get("fetchOnRender")&&(this.model.set("fetchOnRender",!1),this.fetchItems())},render:function(){var e=this,t=this.getSelection();if(this.collection&&this.collection.models.length){this.clearItems();var i=document.createDocumentFragment();this.collection.each(function(t){i.appendChild(e.renderItem(t))}),this.$el.find(".apple-music-items").append(i)}return t.each(function(t){var i="#apple-music-item-apple-music-"+e.tab+"-"+t.get("id");e.$el.find(i).closest(".apple-music-item").addClass("selected details")}),jQuery("#apple-music-button").prop("disabled",!t.length),this},renderItem:function(e){return new o.view.AppleMusicItem({model:e,attributes:{tab:this.tab}}).render().el},createToolbar:function(){var e="";e='<div class="apple-music-error attachments"></div>',this.$el.prepend(e),e='<div class="apple-music-empty attachments"></div>',this.$el.prepend(e),e='<ul class="apple-music-items attachments clearfix"></ul>',this.$el.append(e),e='<div class="apple-music-toolbar media-toolbar clearfix">'+o.template("apple-music-search")(this.model.toJSON())+"</div>",this.$el.prepend(e)},createSidebar:function(){var e=new wp.media.view.Sidebar({controller:this.controller});this.sidebar=e,this.views.add(e)},createSingle:function(e){var t=this.sidebar;t.set("display",new s({controller:this.controller,model:e,priority:160,tab:this.tab})),t.$el.addClass("visible")},removeSelectionHandler:function(e){var t=jQuery("#"+e.currentTarget.id),i=t.attr("data-id");this.removeFromSelection(t,i),e.preventDefault()},toggleSelectionHandler:function(e){if(!e.target.href){var t=jQuery("#"+e.currentTarget.id.replace(/(:|\.|\[|\]|,|=|@)/g,"\\$1")),i=t.attr("data-id");this.getSelection().get(i)?(this.removeFromSelection(t,i),this.disposeSingle()):(this.addToSelection(t,i),this.createSingle(this.getSelection().get(i),i))}},disposeSingle:function(){var e=this.sidebar;e.unset("details"),e.unset("display"),e.$el.removeClass("visible")},addToSelection:function(e,t){this.clearSelection(),this.$el.find(".apple-music-item").removeClass("selected details"),e.closest(".apple-music-item").addClass("selected details"),this.getSelection().add(this.collection._byId[t]),this.controller.state().props.trigger("change:selection")},removeFromSelection:function(e,t){e.closest(".apple-music-item").removeClass("selected details"),this.getSelection().remove(this.collection._byId[t]),this.controller.state().props.trigger("change:selection")},clearSelection:function(){this.getSelection().reset()},getSelection:function(){return this.controller.state().props.get("_all").get("selection")},clearItems:function(){this.$el.find(".apple-music-item").removeClass("selected details"),this.$el.find(".apple-music-items").empty(),this.$el.find(".apple-music-pagination").hide()},loading:function(){this.$el.find(".spinner").addClass("is-active"),this.$el.find(".apple-music-error").hide().text(""),this.$el.find(".apple-music-empty").hide().text(""),jQuery("#apple-music-loadmore").attr("disabled",!0)},loaded:function(){this.$el.find(".spinner").removeClass("is-active")},fetchItems:function(){this.trigger("loading");var e={_nonce:appleMusic._nonce,tab:this.tab,params:this.model.get("params"),page:this.model.get("page"),max_id:this.model.get("max_id")};o.ajax("apple_music_request",{context:this,success:this.fetchedSuccess,error:this.fetchedError,data:e})},fetchedSuccess:function(e){var t=this;if(this.model.get("page")){if(!e.items)return void this.fetchedEmpty(e);this.model.set("items",this.model.get("items").concat(e.items));var i=new Backbone.Collection(e.items),n=document.createDocumentFragment();this.collection.add(i.models),i.each(function(e){n.appendChild(t.renderItem(e))}),this.$el.find(".apple-music-items").append(n)}else{if(!e.items)return void this.fetchedEmpty(e);this.model.set("items",e.items),this.collection.reset(e.items)}jQuery("#apple-music-loadmore").attr("disabled",!e.meta.loadMore).show(),this.trigger("loaded loaded:success",e)},fetchedEmpty:function(e){this.$el.find(".apple-music-empty").text(appleMusic.labels.noresults).show(),this.$el.find(".apple-music-pagination").hide(),this.trigger("loaded loaded:noresults",e)},fetchedError:function(e){this.$el.find(".apple-music-error").text(e.error_message).show(),jQuery("#apple-music-loadmore").attr("disabled",!0).show(),this.trigger("loaded loaded:error",e)},updateInput:function(e){var t=this.model.get("params");this.$el.find(".apple-music-toolbar").find(":input").each(function(){var e=jQuery(this).attr("name");e&&(t[e]=jQuery(this).val())}),this.clearSelection(),jQuery("#apple-music-button").attr("disabled","disabled"),this.model.set("params",t),this.trigger("change:params"),e.preventDefault()},paginate:function(e){if(0!==this.collection.length){var t=this.model.get("page")||1;this.model.set("page",t+1),this.trigger("change:page"),e.preventDefault()}},changedPage:function(){this.fetchItems()},changedParams:function(){this.model.set("page",null),this.clearItems(),this.fetchItems()}});var a=o.view.MediaFrame.Post;function c(e){e.preventDefault(),o({frame:"post",state:"apple-music-service-apple-music"}).open()}o.view.MediaFrame.Post=a.extend({initialize:function(){a.prototype.initialize.apply(this);for(var e="apple-music-service-apple-music",t={id:e,router:e+"-router",toolbar:e+"-toolbar",menu:"default",title:appleMusic.labels.title,tabs:appleMusic.tabs,priority:100},i=r()(appleMusic.tabs),n=void 0,s=0,c=i.length;s<c;s+=1){var l=i[s];this.on("content:render:"+e+"-content-"+l,_.bind(this.appleMusicContentRender,this,appleMusic,l)),void 0===n&&(t.content=e+"-content-"+l,n=!0)}this.states.add([new o.controller.AppleMusic(t)]),this.on("router:create:"+e+"-router",this.createRouter,this),this.on("router:render:"+e+"-router",_.bind(this.appleMusicRouterRender,this,appleMusic)),this.on("toolbar:create:"+e+"-toolbar",this.appleMusicToolbarCreate,this)},appleMusicRouterRender:function(e,t){for(var i={},n=r()(appleMusic.tabs),o=0,s=n.length;o<s;o+=1){var a=n[o];i["apple-music-service-apple-music-content-"+a]={text:appleMusic.tabs[a]}}t.set(i)},appleMusicContentRender:function(e,t){this.content.set(new o.view.AppleMusic({controller:this,model:this.state().props.get(t),tab:t,className:"clearfix attachments-browser apple-music-content apple-music-content-apple-music apple-music-content-apple-music-"+t}))},appleMusicToolbarCreate:function(e){e.view=new o.view.Toolbar.AppleMusic({controller:this})}}),o.controller.AppleMusic=o.controller.State.extend({initialize:function(e){this.props=new Backbone.Collection;for(var t=r()(e.tabs),i=0,n=t.length;i<n;i+=1){var o=t[i];this.props.add(new Backbone.Model({id:o,params:{},page:null,fetchOnRender:e.tabs[o].fetchOnRender}))}this.props.add(new Backbone.Model({id:"_all",selection:new Backbone.Collection})),this.props.on("change:selection",this.refresh,this)},refresh:function(){this.frame.toolbar.get().refresh()},appleMusicInsert:function(){var e=$('.media-sidebar input[name="format"]:checked').val(),t=this.frame.content.get().getSelection(),i=[],n=void 0;t.each(function(t){n=void 0===e?t.get("shortcode"):t.get("shortcode").replace("]",'format="'+e+'"]'),i.push(n)},this),"undefined"==typeof tinymce||null===tinymce.activeEditor||tinymce.activeEditor.isHidden()?o.editor.insert(_.toArray(i).join("\n\n")):o.editor.insert("<p>"+_.toArray(i).join("</p><p>")+"</p>"),t.reset(),this.frame.close()}}),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".apple-music-button");null!==e&&e.addEventListener("click",c)})},function(e,t,i){i(93),e.exports=i(90)}]);
//# sourceMappingURL=mediaModal.bundle.min.js.map